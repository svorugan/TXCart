<mat-card>
  <mat-toolbar color="primary">Hospital Management</mat-toolbar>

  <form class="search-form" (ngSubmit)="applyFilters()" style="display: flex; flex-wrap: wrap; gap: 1rem; align-items: flex-end;">
    <mat-form-field appearance="outline">
      <mat-label>Hospital Name</mat-label>
      <input matInput [(ngModel)]="searchHospitalName" name="searchHospitalName">
      <mat-icon matSuffix>local_hospital</mat-icon>
    </mat-form-field>
    <mat-form-field appearance="outline">
      <mat-label>Location</mat-label>
      <input matInput [(ngModel)]="searchLocation" name="searchLocation">
      <mat-icon matSuffix>location_on</mat-icon>
    </mat-form-field>
    <mat-form-field appearance="outline">
      <mat-label>Tier</mat-label>
      <mat-select [(ngModel)]="searchTier" name="searchTier">
        <mat-option value="">All</mat-option>
        <mat-option value="1">Tier 1</mat-option>
        <mat-option value="2">Tier 2</mat-option>
        <mat-option value="3">Tier 3</mat-option>
      </mat-select>
      <mat-icon matSuffix>star</mat-icon>
    </mat-form-field>
    <mat-form-field appearance="outline">
      <mat-label>City</mat-label>
      <input matInput [(ngModel)]="searchCity" name="searchCity">
      <mat-icon matSuffix>location_city</mat-icon>
    </mat-form-field>
    <mat-form-field appearance="outline">
      <mat-label>State</mat-label>
      <mat-select [(ngModel)]="searchState" name="searchState">
        <mat-option value="">All</mat-option>
        <mat-option *ngFor="let state of states" [value]="state">{{state}}</mat-option>
      </mat-select>
      <mat-icon matSuffix>map</mat-icon>
    </mat-form-field>
    <div style="min-width: 180px; display: flex; flex-direction: column; align-items: start;">
      <label style="font-size: 12px; color: #666; margin-bottom: 4px;">Rating</label>
      <mat-slider min="0" max="5" step="0.5" style="width: 140px;">
        <input matSliderThumb [(ngModel)]="searchRating" name="searchRating" />
      </mat-slider>
      <span style="font-size: 12px; color: #888;">{{searchRating || 0}}</span>
    </div>

    <button mat-raised-button color="primary" type="submit" style="margin-right: 8px;">
      <mat-icon>search</mat-icon> Search
    </button>
    <button mat-stroked-button color="accent" type="button" routerLink="/hospitals/create">
      <mat-icon>add</mat-icon> Add Hospital
    </button>
  </form>

  <!-- Active filters display -->
  <div class="active-filters" *ngIf="hasActiveFilters()" style="margin: 1rem 0;">
    <span style="margin-right: 0.5rem;">Active filters:</span>
    <mat-chip-set>
      <mat-chip *ngIf="searchHospitalName" (removed)="clearFilter('hospitalName')">
        Name: {{searchHospitalName}}
        <button matChipRemove><mat-icon>cancel</mat-icon></button>
      </mat-chip>
      <mat-chip *ngIf="searchLocation" (removed)="clearFilter('location')">
        Location: {{searchLocation}}
        <button matChipRemove><mat-icon>cancel</mat-icon></button>
      </mat-chip>
      <mat-chip *ngIf="searchTier" (removed)="clearFilter('tier')">
        Tier: {{searchTier}}
        <button matChipRemove><mat-icon>cancel</mat-icon></button>
      </mat-chip>
      <mat-chip *ngIf="searchCity" (removed)="clearFilter('city')">
        City: {{searchCity}}
        <button matChipRemove><mat-icon>cancel</mat-icon></button>
      </mat-chip>
      <mat-chip *ngIf="searchState" (removed)="clearFilter('state')">
        State: {{searchState}}
        <button matChipRemove><mat-icon>cancel</mat-icon></button>
      </mat-chip>
      <mat-chip *ngIf="searchRating !== null" (removed)="clearFilter('rating')">
        Rating: {{searchRating}}
        <button matChipRemove><mat-icon>cancel</mat-icon></button>
      </mat-chip>
      <mat-chip color="warn" (click)="clearAllFilters()">
        Clear All
        <mat-icon>clear_all</mat-icon>
      </mat-chip>
    </mat-chip-set>
  </div>

  <mat-table [dataSource]="filteredHospitals" class="mat-elevation-z8">
    <ng-container matColumnDef="id">
      <mat-header-cell *matHeaderCellDef> ID </mat-header-cell>
      <mat-cell *matCellDef="let hospital"> {{hospital.id}} </mat-cell>
    </ng-container>
    <ng-container matColumnDef="name">
      <mat-header-cell *matHeaderCellDef> Name </mat-header-cell>
      <mat-cell *matCellDef="let row">{{row.name}}</mat-cell>
    </ng-container>
    <ng-container matColumnDef="location">
      <mat-header-cell *matHeaderCellDef> Location </mat-header-cell>
      <mat-cell *matCellDef="let row">{{row.location}}</mat-cell>
    </ng-container>
    <ng-container matColumnDef="tier">
      <mat-header-cell *matHeaderCellDef> Tier </mat-header-cell>
      <mat-cell *matCellDef="let row">{{row.tier}}</mat-cell>
    </ng-container>
    <ng-container matColumnDef="city">
      <mat-header-cell *matHeaderCellDef> City </mat-header-cell>
      <mat-cell *matCellDef="let row">{{row.city}}</mat-cell>
    </ng-container>
    <ng-container matColumnDef="state">
      <mat-header-cell *matHeaderCellDef> State </mat-header-cell>
      <mat-cell *matCellDef="let row">{{row.state}}</mat-cell>
    </ng-container>
    <ng-container matColumnDef="rating">
      <mat-header-cell *matHeaderCellDef> Rating </mat-header-cell>
      <mat-cell *matCellDef="let row">{{row.rating}}</mat-cell>
    </ng-container>
    <ng-container matColumnDef="actions">
      <mat-header-cell *matHeaderCellDef> Actions </mat-header-cell>
      <mat-cell *matCellDef="let row">
        <button mat-icon-button color="primary" [routerLink]="['/hospitals/edit', row.id]"><mat-icon>edit</mat-icon></button>
        <button mat-icon-button color="warn" (click)="deleteHospital(row.id)"><mat-icon>delete</mat-icon></button>
      </mat-cell>
    </ng-container>
    <mat-header-row *matHeaderRowDef="displayedColumns; sticky: true"></mat-header-row>
    <mat-row *matRowDef="let row; columns: displayedColumns;"></mat-row>
  </mat-table>
</mat-card>
